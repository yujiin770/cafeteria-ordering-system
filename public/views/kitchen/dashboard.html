<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitchen Display | Oh My-Silog</title>
    <!-- Added a browser favicon just in case -->
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1046/1046784.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../../css/kitchen-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>

    <div id="wrapper">
        <div id="sidebar-overlay"></div>
        <div id="sidebar-placeholder"></div>

        <div id="page-content-wrapper">
            <nav class="navbar navbar-kitchen navbar-expand-lg border-bottom">
                <div class="container-fluid">
                    <button class="btn btn-outline-secondary" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <div class="ms-3">
                        <h5 class="mb-0 fw-bold">Live Kitchen Feed</h5>
                    </div>
                    
                    <div class="ms-auto d-flex align-items-center">
                        <button id="soundToggleBtn" class="btn btn-sm btn-outline-dark rounded-pill me-3 px-3">
                            <i class="fas fa-volume-mute me-1"></i> Sound Off
                        </button>
                        <div class="d-none d-md-block text-end">
                            <span class="d-block small fw-bold text-success"><i class="fas fa-circle small me-1"></i> ONLINE</span>
                            <small class="text-muted font-monospace" id="clock-display">00:00:00</small>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="container-fluid p-4">
                <div class="row mb-4 g-3">
                    <div class="col-md-4">
                        <div class="stat-card pending">
                            <div class="stat-number text-warning" id="pending-count">0</div>
                            <div class="stat-label">Orders Pending</div>
                            <i class="fas fa-bell stat-icon text-warning"></i>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="stat-card preparing">
                            <div class="stat-number text-info" id="preparing-count">0</div>
                            <div class="stat-label">Orders Preparing</div>
                            <i class="fas fa-fire-burner stat-icon text-info"></i>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="stat-card completed">
                            <div class="stat-number text-success" id="completed-count">0</div>
                            <div class="stat-label">Orders Completed</div>
                            <i class="fas fa-clipboard-check stat-icon text-success"></i>
                        </div>
                    </div>
                </div>

                <div class="row g-4" id="orders-container">
                    <div class="col-12 text-center py-5 mt-5">
                        <div class="spinner-border text-warning" role="status"></div>
                        <p class="text-muted mt-3">Connecting to system...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <audio id="alertSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Load Sidebar
            fetch('../partials/_kitchen_sidebar.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('sidebar-placeholder').innerHTML = data;
                    
                    // FORCE ACTIVE STATE ON LIVE ORDERS
                    const liveLink = document.getElementById('nav-live');
                    if(liveLink) liveLink.classList.add('active');
                });

            // Toggle Logic
            const sidebarToggle = document.getElementById('sidebarToggle');
            const wrapper = document.getElementById('wrapper');
            const overlay = document.getElementById('sidebar-overlay');

            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (window.innerWidth >= 768) {
                        const actualSidebar = document.getElementById('sidebar-wrapper');
                        if(actualSidebar) actualSidebar.classList.toggle('collapsed');
                        wrapper.classList.toggle('toggled');
                    } else {
                        const actualSidebar = document.getElementById('sidebar-wrapper');
                        if(actualSidebar) actualSidebar.classList.toggle('mobile-show');
                        if(overlay) overlay.classList.toggle('active');
                    }
                });
            }

            if (overlay) {
                overlay.addEventListener('click', () => {
                    const actualSidebar = document.getElementById('sidebar-wrapper');
                    if(actualSidebar) actualSidebar.classList.remove('mobile-show');
                    overlay.classList.remove('active');
                });
            }
        });
    </script>
    
    <script src="../../js/kitchen/dashboard.js"></script>
</body>
</html>